{% extends "base/base.html" %}
{% block content %}
<!--================Banner Area =================-->
<section class="banner_area">
    <div class="booking_table d_flex align-items-center" style="min-height: 450px">
        <!-- <div class="overlay bg-parallax" data-stellar-ratio="0.9" data-stellar-vertical-offset="0" data-background="">
        </div> -->
        <div class="container">
            <div class="banner_content text-center">
                <h2>個股分析</h2>
            </div>
        </div>
    </div>
    <div class="hotel_booking_area position">
        <div class="container">
            <div class="hotel_booking_table">
                <div class="col-md-3">
                    <h2>請輸入<br> 股票代碼</h2>
                </div>
                <div class="col-md-9">
                    <div class="boking_table">
                        <form class="row" >
                            <!-- {% csrf_token %} -->
                            <div class="col-md-4">
                                <div class="book_tabel_item">
                                    <div class="form-group">
                                        <div class='input-group date' id='datetimepicker11'>
                                            <input name="sDate" required="required" type='text' class="form-control"
                                                placeholder="Start Date" />
                                            <span class="input-group-addon">
                                                <i class="fa fa-calendar" aria-hidden="true"></i>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class='input-group date' id='datetimepicker1'>
                                            <input name="eDate" required="required" type='text' class="form-control"
                                                placeholder="End Date" />
                                            <span class="input-group-addon">
                                                <i class="fa fa-calendar" aria-hidden="true"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="book_tabel_item">
                                    <div class="input-group">
                                        <input placeholder="請輸入股票代碼" required="required" list="stock_id" name="id"
                                            type="text" class="col-sm-12 custom-select custom-select-sm"
                                            style="height: 38px; border-color: #2b3146;color:#777; BACKGROUND-COLOR: transparent;;" />
                                        <datalist class="wide" id="stock_id">
                                            {% for stock in stocks%}
                                            <option value="{{stock.stock_id}}">{{stock.name}}</option>
                                            {% endfor %}
                                        </datalist>
                                    </div>
                                    <div class="input-group">
                                        <input name="fund" required="required" placeholder="請輸入你的資金" min="0"
                                            oninput="if(value<0)value=0" type="number"
                                            class="col-sm-12 custom-select custom-select-sm"
                                            style="height: 38px; border-color: #2b3146;color:#777; BACKGROUND-COLOR: transparent;;" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="book_tabel_item">
                                    <div class="input-group">
                                        <input placeholder="請選擇策略" required="required" list="strategys" name="strategy"
                                            type="text" class="col-sm-12 custom-select custom-select-sm"
                                            style="height: 38px; border-color: #2b3146;color:#777; BACKGROUND-COLOR: transparent;;" />
                                        <datalist class="wide" id="strategys">
                                            <option value="strategy 1">KD</option>
                                            <option value="strategy 2">Bias</option>
                                        </datalist>
                                    </div>
                                    <div class="input-group">
                                        <input type="submit" placeholder="送出" class="book_now_btn button_hover">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 長條圖顯示的位置 -->
<section class="about_history_area section_gap" style="background-color: #ffffff;">
    <div class="container">
        <canvas id="myChart"></canvas>
    </div>
</section>
<!-- 長條圖的原始程式碼, 可以移除掉長條圖就會消失 -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const chartElement = document.getElementById('myChart');
    const data = {
        labels: [
            {% for detail in details%}
            '{{detail.1}}',
            {% endfor %}
        ],
        datasets: [
            {
                label: 'EverytimeProfit',
                data: [
                    {% for detail in details%}
                    {{detail.2}},
                    {% endfor %}
                ]
            },
            {
                label: 'RealizedProfit',
                data: [
                    {% for detail in details%}
                    {{detail.3}},
                    {% endfor %}
                ]
            },
            {
                label: 'UnrealizedProfit',
                data: [
                    {% for detail in details%}
                    {{detail.4}},
                    {% endfor %}
                ]
            },
            // {
            //     label: 'hold_cost',
            //     data: [
            //         {% for detail in details%}
            //         {{detail.5}},
            //         {% endfor %}
            //     ]
            // },
            {
                label: 'hold_volume',
                data: [
                    {% for detail in details%}
                    {{detail.6}},
                    {% endfor %}
                ]
            }
            // },
            // {
            //     label: 'trade_price',
            //     data: [
            //         {% for detail in details%}
            //         {{detail.7}},
            //         {% endfor %}
            //     ]
            // }
        ]
    };
    new Chart(chartElement, {
        type: 'line',
        data: data,
    });
</script>

<!-- 回測資料 -->
{% if TableBool %}
    <section class="about_history_area section_gap" style="background-color: #F8F8FF;">
        <div class="container">
            <table id="example" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>EverytimeProfit</th>
                        <th>RealizedProfit</th>
                        <th>UnrealizedProfit</th>
                        <th>hold_cost</th>
                        <th>hold_volume</th>
                        <th>trade_price</th>
                        <th>trader_fund</th>
                    </tr>
                </thead>
                <tbody>
                    {% for detail in details%}
                    <tr>
                        <td>{{detail.1}}</td>
                        <td>{{detail.2}}</td>
                        <td>{{detail.3}}</td>
                        <td>{{detail.4}}</td>
                        <td>{{detail.5}}</td>
                        <td>{{detail.6}}</td>
                        <td>{{detail.7}}</td>
                        <td>{{detail.8}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Date</th>
                        <th>EverytimeProfit</th>
                        <th>RealizedProfit</th>
                        <th>UnrealizedProfit</th>
                        <th>hold_cost</th>
                        <th>hold_volume</th>
                        <th>trade_price</th>
                        <th>trader_fund</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </section>
{% endif %}
{% endblock %}